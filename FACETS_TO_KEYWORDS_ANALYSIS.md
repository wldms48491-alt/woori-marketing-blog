# 자동 추출 태그 및 키워드 분석 개선 방안

## 현재 상태 분석

### ✅ 해결된 부분
- 위치 추출: "경기 광주시" 정확히 추출됨
- Facets 추출: category, items, audience, features, vibe, price_range 등 다양한 정보 추출

### ❌ 문제점

#### 1. Facets 데이터 활용 부족
```
현재 출력:
{
  "category": ["세차장"],
  "items": [
    {"name": "스팀세차", "signature": true},
    {"name": "광택", "signature": false},
    {"name": "손세차", "signature": false}
  ],
  "audience": ["차량 소유주", "세차 고객"],
  "features": ["30년 경력 정비사 운영", "맞춤형 세차 서비스"],
  "vibe": ["전문적인"],
  "price_range": ["중가"],
  "trade_area": ["광주시", "경기"]
}
```

이 풍부한 정보가 **키워드 분석에 전혀 활용되지 않음**

#### 2. Rank-Keywords 엔드포인트 문제
```
현재 키워드:
- 원스팀마스타
- 경기 카페 (← 잘못된 카테고리!)
- 광주시 핫플
- 인기 카페 (← 세차장인데 카페?)
- 추천 매장
```

문제:
- Facets의 category를 무시하고 하드코딩된 "카페" 사용
- 추출된 items(메뉴/서비스)를 키워드로 변환 안함
- 상권 정보와 카테고리 조합 없음
- 검색량(sv), 경쟁도 등이 임의로 설정됨

#### 3. 키워드 전략 부재
- **영역 키워드 없음**: "광주 세차장", "경기도 세차"
- **서비스 키워드 없음**: "스팀세차", "광택 세차", "손세차"
- **타겟 키워드 없음**: "차량 관리", "가성비 세차"
- **브랜드 키워드 없음**: "원스팀마스타"
- **경쟁 키워드 없음**: "추천 세차장", "인기 세차"

## 개선 방안

### Phase 1: Facets 기반 지능형 키워드 생성

#### 단계별 키워드 전략
```
1. 브랜드/명칭 키워드 (매우 높은 의도)
   - "원스팀마스타"
   - "원스팀마스타 광주"
   - "원스팀마스타 세차"

2. 지역 + 카테고리 키워드 (높은 의도)
   - "광주 세차장"
   - "경기도 광주 세차"
   - "광주시 자동차 세차"

3. 서비스 키워드 (높은 의도)
   - "스팀세차" (signature item)
   - "광택 세차"
   - "손세차 전문"

4. 타겟 키워드 (중간 의도)
   - "가성비 좋은 세차"
   - "전문 세차장"
   - "차량 관리 서비스"

5. 일반 검색 키워드 (낮은 의도)
   - "세차 전문점"
   - "자동차 세차 방법"
   - "세차장 추천"
```

### Phase 2: Gemini를 활용한 키워드 점수화

```
입력:
- Facets (category, items, audience, features, price_range)
- Location (city, district)
- Place name

처리:
1. Gemini에 키워드 추천 요청
2. 각 키워드에 대한 점수 산출:
   - sv (검색량): 카테고리+지역+특성 기반
   - doc_t (문서량): 경쟁도
   - lc_score (지역 관련성): 지역명 포함 정도
   - conf (신뢰도): Facets 매칭도

출력: 50-100개의 정렬된 키워드
```

### Phase 3: 데이터 구조 개선

현재 응답의 `trade_area` 필드:
```typescript
trade_area: ["광주시", "경기"]
```

개선안:
```typescript
keywords: {
  brand: ["원스팀마스타", "원스팀마스타 광주"],
  location: ["광주 세차", "경기도 광주 세차장"],
  service: ["스팀세차", "광택 세차", "손세차"],
  target: ["가성비 세차", "전문 세차장"],
  general: ["세차 전문점", "자동차 관리"],
}

// 키워드 상세 정보
keywordDetails: [
  {
    keyword: "광주 세차장",
    category: "location+service",
    sv: 2100,
    doc_t: 1200,
    lc_score: 95,
    confidence: 0.92,
    reason: "지역+카테고리+신뢰도 높음"
  }
]
```

## 구현 우선순위

1. **즉시 (High)**: rank-keywords 개선
   - Facets 데이터 활용
   - Gemini 기반 키워드 분석
   - 점수 시스템 개선

2. **단기 (Medium)**: 키워드 분류
   - 카테고리별 키워드 구분
   - 상세 점수 정보 추가

3. **장기 (Low)**: 검증 및 최적화
   - 실제 검색량 API 연동
   - A/B 테스트
