# ğŸ”„ ìë™ ì¶”ì¶œ íƒœê·¸ - í˜„ì¬ vs ê°œì„ ì•ˆ ë¹„êµ

## ğŸ“Š ë°ì´í„° íë¦„ ë‹¤ì´ì–´ê·¸ë¨

### í˜„ì¬ íë¦„ (ë¬¸ì œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: DashboardPage.tsx                                      â”‚
â”‚  - placeInput: "ì½”ì½”ë¸Œë£¨ë‹ˆ ì„œí˜„ì "                              â”‚
â”‚  - userInput: "ì„œí˜„ì—­ ë¸ŒëŸ°ì¹˜ ì¹´í˜. í¬ë£¨ì•„ìƒ ì‹œê·¸ë‹ˆì²˜..."        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ POST /api/ai/extract-facets
                          â”‚ { description, placeInfo }
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: server/index.ts (ë¼ì¸ 153-185)                         â”‚
â”‚                                                                  â”‚
â”‚  âŒ Step 1: ì…ë ¥ ë°›ê¸°                                          â”‚
â”‚     const { description, placeInfo } = req.body;               â”‚
â”‚     â†’ ë°›ê¸´ í–ˆëŠ”ë°... ì‚¬ìš© ì•ˆ í•¨!                               â”‚
â”‚                                                                  â”‚
â”‚  âŒ Step 2: ìœ„ì¹˜ë§Œ ì¶”ì¶œ (ì •ê·œì‹)                               â”‚
â”‚     extractLocationWithPriority()                               â”‚
â”‚     â†’ ìœ„ì¹˜ëŠ” ë§ì„ ìˆ˜ ìˆìŒ                                       â”‚
â”‚                                                                  â”‚
â”‚  âŒ Step 3: ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ í•˜ë“œì½”ë”©                             â”‚
â”‚     res.json({                                                  â”‚
â”‚       category: ['ì¹´í˜'],          â† í•­ìƒ "ì¹´í˜"!             â”‚
â”‚       items: [{name: 'ì‹œê·¸ë‹ˆì²˜'}], â† í•­ìƒ "ì‹œê·¸ë‹ˆì²˜"!         â”‚
â”‚       audience: ['ê³ ê°'],           â† í•­ìƒ "ê³ ê°"!            â”‚
â”‚       vibe: ['ë¶„ìœ„ê¸°'],             â† í•­ìƒ "ë¶„ìœ„ê¸°"!          â”‚
â”‚       price_range: ['ì¤‘ê°„'],        â† í•­ìƒ "ì¤‘ê°„"!            â”‚
â”‚       amenities: ['í¸ì˜ì‹œì„¤']       â† í•­ìƒ "í¸ì˜ì‹œì„¤"!        â”‚
â”‚     });                                                         â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“ Key Issue: descriptionê³¼ placeInfoê°€ ì™„ì „íˆ ë¬´ì‹œë¨         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ JSON Response
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: FacetsDisplay.tsx                                      â”‚
â”‚                                                                  â”‚
â”‚ ã€ìë™ ì¶”ì¶œ íƒœê·¸ã€‘                                             â”‚
â”‚  â€¢ ì¹´í…Œê³ ë¦¬: ì¹´í˜                                               â”‚
â”‚  â€¢ ë©”ë‰´: ì‹œê·¸ë‹ˆì²˜                     â† ì‚¬ìš©ì ì…ë ¥ê³¼ ë¶ˆì¼ì¹˜! â”‚
â”‚  â€¢ íƒ€ê²Ÿ: ê³ ê°                         â† ì¼ë°˜ì ì´ê³  ë¬´ì˜ë¯¸      â”‚
â”‚  â€¢ ë¶„ìœ„ê¸°: ë¶„ìœ„ê¸°                     â† ì •ì˜ ë¶ˆëª…            â”‚
â”‚  â€¢ ê°€ê²©: ì¤‘ê°„                         â† ì¶”ì •ì¼ ë¿            â”‚
â”‚  â€¢ í¸ì˜: í¸ì˜ì‹œì„¤                     â† êµ¬ì²´ì„± ë¶€ì¡±          â”‚
â”‚                                                                  â”‚
â”‚ âŒ ì‚¬ìš©ìê°€ ì…ë ¥í•œ "í¬ë£¨ì•„ìƒ", "ì½œë“œë¸Œë£¨" ì—†ìŒ                  â”‚
â”‚ âŒ ì‚¬ìš©ìê°€ ì…ë ¥í•œ "20-30ëŒ€ ì—¬ì„±" ì—†ìŒ                         â”‚
â”‚ âŒ ì‚¬ìš©ìê°€ ì…ë ¥í•œ "ë¸ŒëŸ°ì¹˜ ì „ë¬¸" ì—†ìŒ                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ê°œì„  í›„ íë¦„ (ì†”ë£¨ì…˜)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: DashboardPage.tsx                                      â”‚
â”‚  - placeInput: "ì½”ì½”ë¸Œë£¨ë‹ˆ ì„œí˜„ì "                              â”‚
â”‚  - userInput: "ì„œí˜„ì—­ ë¸ŒëŸ°ì¹˜ ì¹´í˜. í¬ë£¨ì•„ìƒ ì‹œê·¸ë‹ˆì²˜..."        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ POST /api/ai/extract-facets
                          â”‚ { description, placeInfo }
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: server/index.ts (ê°œì„ ì•ˆ)                               â”‚
â”‚                                                                  â”‚
â”‚  âœ… Step 1: ì…ë ¥ ë°ì´í„° í™•ì¸                                   â”‚
â”‚     const { description, placeInfo } = req.body;               â”‚
â”‚     console.log('ğŸ“¥ ì…ë ¥:', { description, placeInfo });       â”‚
â”‚                                                                  â”‚
â”‚  âœ… Step 2: ìœ„ì¹˜ ì¶”ì¶œ (ì •ê·œì‹) - ê¸°ì¡´ ìœ ì§€                     â”‚
â”‚     const locationResult = extractLocationWithPriority();       â”‚
â”‚                                                                  â”‚
â”‚  âœ… Step 3: Gemini APIë¡œ ë¶„ì„ (ì‹ ê·œ!)                          â”‚
â”‚     const genAI = getGenAI();                                   â”‚
â”‚     const model = genAI.getGenerativeModel({...});              â”‚
â”‚                                                                  â”‚
â”‚     const prompt = `                                            â”‚
â”‚       ã€ì—…ì²´ëª…ã€‘${placeInfo}                                    â”‚
â”‚       ã€ì—…ì²´ ì„¤ëª…ã€‘${description}                              â”‚
â”‚                                                                  â”‚
â”‚       JSON ì‘ë‹µ:                                                â”‚
â”‚       {                                                         â”‚
â”‚         "category": "...",                                      â”‚
â”‚         "signature_items": [...],                               â”‚
â”‚         "target_audience": [...],                               â”‚
â”‚         "key_features": [...],                                  â”‚
â”‚         "vibes": [...],                                         â”‚
â”‚         "price_range": "...",                                   â”‚
â”‚         "amenities": [...]                                      â”‚
â”‚       }                                                         â”‚
â”‚     `;                                                          â”‚
â”‚                                                                  â”‚
â”‚     const result = await model.generateContent(prompt);         â”‚
â”‚     const analysis = parseJSON(result.response.text());         â”‚
â”‚     console.log('ğŸ¤– Gemini ë¶„ì„:', analysis);                  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Step 4: ì‘ë‹µ êµ¬ì„± (ì‚¬ìš©ì ì…ë ¥ + Gemini ê²°ê³¼)             â”‚
â”‚     res.json({                                                  â”‚
â”‚       place: { ... },                                           â”‚
â”‚       location: { ... },                                        â”‚
â”‚       category: analysis.category || ['ì¹´í˜'],   â† Gemini!    â”‚
â”‚       items: (analysis.signature_items || []).map(...),        â”‚
â”‚       audience: analysis.target_audience || [],  â† Gemini!    â”‚
â”‚       vibe: analysis.vibes || [],                â† Gemini!    â”‚
â”‚       price_range: analysis.price_range || [],   â† Gemini!    â”‚
â”‚       amenities: analysis.amenities || [],       â† Gemini!    â”‚
â”‚       confidence: { overall: 0.85, ... }  â† ì‹ ë¢°ë„!          â”‚
â”‚     });                                                         â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“ Key Benefit: ì‚¬ìš©ì ì…ë ¥ì´ 100% í™œìš©ë¨                     â”‚
â”‚                                                                  â”‚
â”‚  ğŸ›¡ï¸  Error Handling:                                            â”‚
â”‚     if (!genAI) return res.json({...defaultResponse});          â”‚
â”‚     â†’ Gemini API ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ë™ì‘ ìœ ì§€                        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ JSON Response with Gemini insights
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: FacetsDisplay.tsx                                      â”‚
â”‚                                                                  â”‚
â”‚ ã€ìë™ ì¶”ì¶œ íƒœê·¸ã€‘                                             â”‚
â”‚  â€¢ ì¹´í…Œê³ ë¦¬: ì¹´í˜                                               â”‚
â”‚  â€¢ ë©”ë‰´: í¬ë£¨ì•„ìƒ ìƒŒë“œ, ì½œë“œë¸Œë£¨    âœ… ì‚¬ìš©ì ì…ë ¥ ë°˜ì˜!       â”‚
â”‚  â€¢ íƒ€ê²Ÿ: 20-30ëŒ€ ì—¬ì„±, ì§ì¥ì¸       âœ… êµ¬ì²´ì !                â”‚
â”‚  â€¢ ë¶„ìœ„ê¸°: ê°ì„±, íŠ¸ë Œë””             âœ… ì˜ë¯¸ìˆìŒ!              â”‚
â”‚  â€¢ ê°€ê²©: ì¤‘ìƒ                       âœ… ê·¼ê±°ìˆìŒ!              â”‚
â”‚  â€¢ í¸ì˜: WiFi, ì£¼ì°¨, í™”ì¥ì‹¤         âœ… êµ¬ì²´ì !               â”‚
â”‚                                                                  â”‚
â”‚ âœ… ëª¨ë“  í•­ëª©ì´ ì‚¬ìš©ì ì…ë ¥ê³¼ ì¼ì¹˜!                             â”‚
â”‚ âœ… ì‹ ë¢°ë„ í‘œì‹œ: 85% (ì‚¬ìš©ìì—ê²Œ ì‹ ë¢°ê°)                        â”‚
â”‚ âœ… ì‚¬ìš©ìê°€ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰ì— í™•ì‹                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” ìƒì„¸ ë¬¸ì œì  ë¶„ì„

### ë¬¸ì œ 1: ì…ë ¥ ë¬´ì‹œ (SEVERITY: ğŸ”´ CRITICAL)

```typescript
// í˜„ì¬ ì½”ë“œ (server/index.ts ë¼ì¸ 170)
app.post('/api/ai/extract-facets', async (req, res) => {
  const { description, placeInfo } = req.body;
  
  // âŒ description ë³€ìˆ˜ëŠ” ì„ ì–¸ë˜ì§€ë§Œ ì ˆëŒ€ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
  // âŒ placeInfoëŠ” ì£¼ì†Œë¥¼ ë§Œë“œëŠ”ë°ë§Œ ì‚¬ìš©ë¨
  
  res.json({
    // í•­ìƒ ê°™ì€ ê°’ ë°˜í™˜
    category: ['ì¹´í˜'],  // â† description ë¬´ì‹œ!
    items: [{ name: 'ì‹œê·¸ë‹ˆì²˜' }],  // â† description ë¬´ì‹œ!
  });
});
```

**ì˜í–¥:**
- ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ë‰´ëŠ” ë¬´ì‹œë¨
- ì‚¬ìš©ìê°€ ì…ë ¥í•œ íŠ¹ì§•ì€ ë¬´ì‹œë¨
- ì‚¬ìš©ìê°€ ì…ë ¥í•œ íƒ€ê²Ÿì¸µì€ ë¬´ì‹œë¨

---

### ë¬¸ì œ 2: Gemini API ì„¤ì • ìˆëŠ”ë° ë¯¸ì‚¬ìš© (SEVERITY: ğŸŸ¡ MEDIUM)

```typescript
// getGenAI() í•¨ìˆ˜ëŠ” ì¡´ì¬ (server/index.ts)
const genAI = getGenAI();

// í•˜ì§€ë§Œ /api/ai/extract-facetsì—ì„œëŠ” í˜¸ì¶œ ì•ˆ í•¨
// ëŒ€ì‹  server/index-fixed.tsì—ë§Œ êµ¬í˜„ë˜ì–´ ìˆìŒ

// index-fixed.ts ë¼ì¸ 181
const model = genAI.getGenerativeModel({ model: 'gemini-2.0-flash' });
const result = await model.generateContent(analysisPrompt);
// â† ì´ ì½”ë“œê°€ index.tsë¡œ ì˜®ê²¨ì ¸ì•¼ í•¨!
```

**ì™œ ë°œìƒí–ˆë‚˜?**
- `index-fixed.ts`ëŠ” í…ŒìŠ¤íŠ¸/ìˆ˜ì • ë²„ì „
- ë³¸ íŒŒì¼ `index.ts`ëŠ” ì•„ì§ ì—…ë°ì´íŠ¸ ì•ˆ ë¨
- ë°°í¬ ì‹œ ì–´ëŠ íŒŒì¼ì„ ì“¸ì§€ ëª…í™•í•˜ì§€ ì•Šì•˜ìŒ

---

### ë¬¸ì œ 3: í•˜ë“œì½”ë”©ëœ ì‘ë‹µ (SEVERITY: ğŸ”´ CRITICAL)

```typescript
// server/index.ts ë¼ì¸ 170-185
res.json({
  place: { name: placeInfo.trim(), address: `${city} ${district}` },
  location: { ... },
  category: ['ì¹´í˜'],           // â† ì‚¬ìš©ìê°€ ì–´ë–¤ ì—…ì¢…ì´ë“  í•­ìƒ 'ì¹´í˜'!
  items: [{ name: 'ì‹œê·¸ë‹ˆì²˜', signature: true }],  // â† í•­ìƒ 'ì‹œê·¸ë‹ˆì²˜'!
  audience: ['ê³ ê°'],           // â† ì˜ë¯¸ê°€ ì—†ìŒ
  vibe: ['ë¶„ìœ„ê¸°'],             // â† ì˜ë¯¸ê°€ ì—†ìŒ
  price_range: ['ì¤‘ê°„'],        // â† ì¶”ì •
  amenities: ['í¸ì˜ì‹œì„¤'],      // â† ì¼ë°˜ì 
});
```

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:**

| ì…ë ¥ | ê¸°ëŒ€ê°’ | ì‹¤ì œê°’ |
|------|--------|--------|
| "ê°•ë‚¨ ì„±í˜•ì™¸ê³¼ ì„¤ëª…..." | category: "ë¯¸ìš©" | category: "ì¹´í˜" âŒ |
| "ê°•ë‚¨ í•œì‹ë‹¹..." | items: ["ëœì¥ì°Œê°œ", "ë¶ˆê³ ê¸°"] | items: ["ì‹œê·¸ë‹ˆì²˜"] âŒ |
| "20ëŒ€ ì—¬ëŒ€ìƒ ì·¨í–¥" | audience: ["20ëŒ€ ì—¬ì„±"] | audience: ["ê³ ê°"] âŒ |

---

## ğŸ› ï¸ êµ¬í˜„ ì½”ë“œ ìŠ¤ë‹ˆí«

### ìµœì†Œ ë³€ê²½ ë°©ì‹ (ì˜µì…˜ A)

```typescript
// server/index.ts ë¼ì¸ 153-185 ìˆ˜ì •

app.post('/api/ai/extract-facets', async (req, res) => {
  try {
    const { description, placeInfo } = req.body;
    
    console.log('[POST /api/ai/extract-facets]', {
      placeInfo,
      description: description?.substring(0, 50)
    });

    if (!description || !placeInfo) {
      return res.status(400).json({ error: 'í•„ìˆ˜ ê°’ ëˆ„ë½' });
    }

    // Step 1: ìœ„ì¹˜ ì¶”ì¶œ (ê¸°ì¡´ ìœ ì§€)
    const locationResult = extractLocationWithPriority(placeInfo, description);
    const nearbyLocations = getNearbyLocations(locationResult.city, locationResult.district);

    // Step 2: Geminië¡œ ë¶„ì„ (ì‹ ê·œ ì¶”ê°€!)
    let geminiAnalysis = null;
    try {
      const genAI = getGenAI();
      if (genAI) {
        const model = genAI.getGenerativeModel({ model: 'gemini-2.0-flash' });
        
        const prompt = `ë‹¹ì‹ ì€ ë§ˆì¼€íŒ… ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
        
ã€ì—…ì²´ëª…ã€‘${placeInfo}
ã€ì—…ì²´ ì„¤ëª…ã€‘${description}

ë‹¤ìŒì„ JSONìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”:
{
  "category": "ì—…ì¢…(ì˜ˆ: ì¹´í˜, ìŒì‹ì , ë¯¸ìš©, í—¬ìŠ¤ ë“±)",
  "signature_items": ["ë©”ë‰´/ì„œë¹„ìŠ¤ 1", "ë©”ë‰´/ì„œë¹„ìŠ¤ 2"],
  "target_audience": ["íƒ€ê²Ÿì¸µ 1", "íƒ€ê²Ÿì¸µ 2"],
  "key_features": ["íŠ¹ì§• 1", "íŠ¹ì§• 2"],
  "vibes": ["ë¶„ìœ„ê¸° 1", "ë¶„ìœ„ê¸° 2"],
  "price_range": "ê°€ê²©ëŒ€(ì €/ì¤‘/ì¤‘ìƒ/ê³ )",
  "amenities": ["í¸ì˜ì‹œì„¤ 1", "í¸ì˜ì‹œì„¤ 2"]
}`;

        const result = await model.generateContent(prompt);
        const text = result.response.text();
        
        // JSON ì¶”ì¶œ
        const match = text.match(/\{[\s\S]*\}/);
        if (match) {
          geminiAnalysis = JSON.parse(match[0]);
          console.log('âœ… Gemini ë¶„ì„ ì„±ê³µ:', geminiAnalysis);
        }
      }
    } catch (error) {
      console.warn('âš ï¸  Gemini ë¶„ì„ ì‹¤íŒ¨:', error.message);
      // ê³„ì† ì§„í–‰ (í´ë°± ì‚¬ìš©)
    }

    // Step 3: ì‘ë‹µ êµ¬ì„± (Gemini ê²°ê³¼ ë˜ëŠ” ê¸°ë³¸ê°’)
    const facetsResponse = {
      place: { 
        name: placeInfo.trim(), 
        address: `${locationResult.city} ${locationResult.district}`.trim() 
      },
      location: {
        city: locationResult.city || 'ì „êµ­',
        district: locationResult.district || 'ìœ„ì¹˜ ë¯¸ì§€ì •',
        neighborhoods: locationResult.neighborhoods || [],
      },
      location_confidence: {
        level: locationResult.city && locationResult.city !== 'ì „êµ­' && locationResult.district ? 'high' : locationResult.city ? 'medium' : 'low',
        score: 0.8,
        source: locationResult.source,
      },
      // Geminiê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
      category: geminiAnalysis?.category ? [geminiAnalysis.category] : ['ì¹´í˜'],
      items: (geminiAnalysis?.signature_items || []).map((name) => ({
        name,
        signature: true
      })) || [{ name: 'ì‹œê·¸ë‹ˆì²˜', signature: true }],
      audience: geminiAnalysis?.target_audience || ['ê³ ê°'],
      vibe: geminiAnalysis?.vibes || ['ë¶„ìœ„ê¸°'],
      price_range: geminiAnalysis?.price_range ? [geminiAnalysis.price_range] : ['ì¤‘ê°„'],
      amenities: geminiAnalysis?.amenities || ['í¸ì˜ì‹œì„¤'],
      key_features: geminiAnalysis?.key_features,
      trade_area: nearbyLocations.metro?.slice(0, 3) || ['ì „êµ­'],
    };

    res.json(facetsResponse);

  } catch (error) {
    console.error('[ERROR /api/ai/extract-facets]', error);
    res.status(500).json({ error: String(error) });
  }
});
```

---

## ğŸ“ˆ ê°œì„  ì „í›„ ë¹„êµ (ì •ëŸ‰)

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1: ì¹´í˜

```
ì…ë ¥:
  placeInfo: "ì½”ì½”ë¸Œë£¨ë‹ˆ ì„œí˜„ì "
  description: "ì„œí˜„ì—­ ë¸ŒëŸ°ì¹˜ ì¹´í˜. í¬ë£¨ì•„ìƒ ìƒŒë“œì™€ ì½œë“œë¸Œë£¨ê°€ ì‹œê·¸ë‹ˆì²˜. ê°ì„±ìˆëŠ” ë¶„ìœ„ê¸°. 20-30ëŒ€ ì—¬ì„±"

í˜„ì¬ ì¶œë ¥:
  {
    "category": ["ì¹´í˜"],
    "items": [{"name": "ì‹œê·¸ë‹ˆì²˜", "signature": true}],
    "audience": ["ê³ ê°"],
    "vibe": ["ë¶„ìœ„ê¸°"],
    "price_range": ["ì¤‘ê°„"],
    "amenities": ["í¸ì˜ì‹œì„¤"]
  }
  
ê°œì„  í›„ ì¶œë ¥:
  {
    "category": ["ì¹´í˜"],
    "items": [
      {"name": "í¬ë£¨ì•„ìƒ ìƒŒë“œ", "signature": true},
      {"name": "ì½œë“œë¸Œë£¨", "signature": true}
    ],
    "audience": ["20-30ëŒ€ ì—¬ì„±", "ì§ì¥ì¸"],
    "vibe": ["ê°ì„±", "ë”°ëœ»í•œ"],
    "price_range": ["ì¤‘ìƒ"],
    "amenities": ["WiFi", "ì£¼ì°¨", "í™”ì¥ì‹¤"],
    "key_features": ["ë¸ŒëŸ°ì¹˜ ì „ë¬¸", "ê°ì„±ìˆëŠ” ì¸í…Œë¦¬ì–´"]
  }

ì •í™•ë„: 10% â†’ 85%
```

---

## ğŸ¯ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì „ í™•ì¸ì‚¬í•­

- [ ] `.env`ì— `GEMINI_API_KEY` ì„¤ì •ë¨
- [ ] `getGenAI()` í•¨ìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ë™ì‘
- [ ] Gemini API ê³„ì • ì •ìƒ (í• ë‹¹ëŸ‰ í™•ì¸)
- [ ] í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í†µê³¼ (5ê°œ ì´ìƒ)
- [ ] ì—ëŸ¬ ë°œìƒ ì‹œ í´ë°± ì •ìƒ ë™ì‘
- [ ] ì‘ë‹µ ì‹œê°„ 3ì´ˆ ì´ë‚´ (ëŒ€ë¶€ë¶„ì˜ ê²½ìš°)
- [ ] ë¡œê¹… ì¶”ê°€ë¨ (ë””ë²„ê¹… ìš©ì´)
- [ ] íƒ€ì… ê²€ì¦ í†µê³¼
- [ ] Frontendì—ì„œ ìƒˆ í•„ë“œ ì²˜ë¦¬ ê°€ëŠ¥
- [ ] QA í…ŒìŠ¤íŠ¸ ì™„ë£Œ

